<%- include('../partials/admin-header') %>

<div class="admin-header">
  <h1>Manage Roles</h1>
  <a href="/admin" class="btn btn-outline">Back to Dashboard</a>
</div>

<div class="roles-page">
  <div class="form-container" style="max-width:100%;margin-bottom:32px">
    <form action="/admin/roles/new" method="POST" class="admin-form">
      <h3>Create New Role</h3>
      <div class="form-row">
        <div class="form-group">
          <label for="name">Role Name</label>
          <input type="text" id="name" name="name" required placeholder="e.g. Manager, Editor">
        </div>
        <div class="form-group">
          <label for="description">Description</label>
          <input type="text" id="description" name="description" placeholder="What this role can do">
        </div>
      </div>
      <button type="submit" class="btn btn-primary">Create Role</button>
    </form>
  </div>

  <div class="table-responsive">
    <table class="admin-table">
      <thead>
        <tr>
          <th>Role</th>
          <th>Description</th>
          <th>Permissions</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% roles.forEach(role => { %>
          <tr>
            <td><strong><%= role.name %></strong></td>
            <td><%= role.description || '-' %></td>
            <td>
              <a href="/admin/roles/edit/<%= role.id %>" class="btn btn-sm btn-primary">Set Permissions</a>
            </td>
            <td class="actions-cell">
              <a href="/admin/roles/edit/<%= role.id %>" class="btn btn-sm btn-outline">Edit</a>
              <% if (role.name !== 'Super Admin') { %>
                <form action="/admin/roles/delete/<%= role.id %>" method="POST" style="display:inline" onsubmit="return confirm('Delete this role? Users with this role will lose their permissions.')">
                  <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                </form>
              <% } %>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>

<%- include('../partials/admin-footer') %>
